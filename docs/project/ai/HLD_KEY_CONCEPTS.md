# HLD Key Concepts Reference

This document extracts the most important concepts from the High Level Design for quick reference during development.

## Core Innovation

The Esper Morphogenetic Training Platform enables neural networks to function as **adaptive, evolving entities** capable of autonomous structural modification while being trained.

### Two Sophisticated Neural Network Agents
1. **Strategic Controller (Tamiyo)** - Analyzes the host model and identifies where/when architectural interventions yield greatest benefit
2. **Generative Architect (Karn)** - Automated R&D engine continuously inventing new architectural primitives

### Nested Learning Paradigm
Multiple learning processes operate simultaneously:
- Base model learns its primary task
- Controller learns optimal intervention strategies  
- Architect learns to design better solutions

## Fundamental Unit: Seeds

Seeds are the **fundamental unit of morphogenetic change**:

- **Monitor** a specific "chunk" of neurons, collecting telemetry
- **Encapsulate** latent developmental potential (like stem cells)
- **Report** multi-dimensional health metrics (variance, entropy, correlation)
- **Execute** the 11-stage lifecycle under strict interface contract preservation

### Key Principle
Seeds implement **local objective encapsulation**, enabling targeted optimization without global interference.

## Blueprint vs Kernel Distinction

Critical distinction between design and executable form:

- **Blueprint** - Architectural design (BlueprintIR) generated by Karn
- **Compiled Kernel** - Optimized executable form produced by Tezzeret
- **Validation** - Urabrask benchmarks and characterizes kernels
- **Deployment** - Only validated kernels available for Tamiyo to select

This separates "genotype" (design) from "phenotype" (validated artifact).

## 11-Stage Morphogenetic Lifecycle

Three-phase validation ensures safety:

### Phase 1 - Pre-Integration (Stages 1-3)
- DORMANT → GERMINATED → TRAINING
- Blueprint trained in isolation

### Phase 2 - Controlled Integration (Stages 4-6)  
- GRAFTING → STABILIZATION → EVALUATING
- Gradual integration with impact evaluation

### Phase 3 - Final Determination (Stages 7-11)
- FINE_TUNING → FOSSILIZED/CULLED/CANCELLED/ROLLED_BACK
- Final decision based on global performance

## Zero Training Disruption

**Cornerstone principle**: Asynchronous compilation pipeline ensures training never blocked.

- Blueprint compilation offloaded to background services
- Primary training loop proceeds uninterrupted
- Kernels compiled, validated, characterized in parallel
- Available for deployment without pausing training momentum

## Three Functional Planes

### Training Plane
- **Tolaria** - Training orchestrator
- **Kasmina** - Execution layer (pure executor)

### Control Plane
- **Tamiyo** - Strategic controller
- **Simic** - Policy training environment
- **Emrakul** - Architectural sculptor

### Innovation Plane (Asynchronous)
- **Karn** - Generative architect
- **Tezzeret** - Compilation forge
- **Urabrask** - Evaluation engine
- **Urza** - Central library

## Kasmina Layer Architecture

Kasmina uses a "chunked architecture":
- Layer's activation tensor split into chunks
- Each chunk processed by independent KasminaSeed
- Seeds can load different kernels dynamically
- Alpha blending controls kernel influence
- Seeds have lifecycle states (DORMANT, LOADING, ACTIVE, ERROR_RECOVERY)

## Key Safety Mechanisms

1. **Interface Integrity** - Zero tolerance for shape/type violations
2. **Gradient Isolation** - Stable parameters protected during adaptation
3. **Validated Kernel Deployment** - 100% of kernels must pass validation
4. **Rollback Capability** - Instant restoration to pre-adaptation state
5. **Comprehensive Audit Trail** - Full traceability of all modifications

## Performance Targets

- **Success Rate**: >90% resolution of identified bottlenecks
- **Stability**: <5% performance degradation after 20+ adaptations
- **Efficiency**: 10-100x fewer parameters than traditional approaches
- **Latency**: <5% inference overhead
- **Compilation**: Zero training disruption

## Implementation Phases

### Phase 1 (Complete)
- Single-server deployment
- Core morphogenetic mechanics validation
- Smaller models and research environments

### Phase 2 (Complete)
- Tamiyo GNN-based intelligence
- Autonomous decision-making
- Production-ready safety mechanisms

### Future Phases
- Full distribution with Kubernetes
- Enterprise-grade security
- Large-scale model support